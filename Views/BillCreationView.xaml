<?xml version="1.0" encoding="UTF-8" ?>
<Page
    x:Class="RepairShopBilling.Views.BillCreationView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{StaticResource DarkGreyBackgroundBrush}">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Assets/Styles/AppStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Header with Solid State Dave Logo -->
            <Image 
                Grid.Row="0"
                Source="/Assets/Styles/Solid State Dave.png" 
                Height="60"
                Margin="0,0,0,20"
                HorizontalAlignment="Center"
                VerticalAlignment="Top" />

            <!-- Customer Information Section -->
            <Border Grid.Row="1" Style="{StaticResource BillCard}" Margin="0,0,0,20">
                <StackPanel Spacing="16">
                    <TextBlock 
                        Text="Customer Information" 
                        Foreground="{StaticResource WhiteTextBrush}"
                        FontSize="18"
                        FontWeight="SemiBold" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Spacing="8">
                            <TextBlock 
                                Text="Customer Name" 
                                Foreground="{StaticResource LightGreyTextBrush}"
                                FontSize="14" />
                            <TextBox 
                                x:Name="CustomerNameTextBox"
                                Style="{StaticResource RoundedTextBox}"
                                PlaceholderText="Enter customer name"
                                Text="{x:Bind ViewModel.CustomerName, Mode=TwoWay}" />
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" Spacing="8">
                            <TextBlock 
                                Text="Device Type" 
                                Foreground="{StaticResource LightGreyTextBrush}"
                                FontSize="14" />
                            <TextBox 
                                x:Name="DeviceTypeTextBox"
                                Style="{StaticResource RoundedTextBox}"
                                PlaceholderText="e.g., Laptop, Desktop, Phone"
                                Text="{x:Bind ViewModel.DeviceType, Mode=TwoWay}" />
                        </StackPanel>
                        
                        <StackPanel Grid.Column="4" Spacing="8">
                            <TextBlock 
                                Text="Date" 
                                Foreground="{StaticResource LightGreyTextBrush}"
                                FontSize="14" />
                            <DatePicker 
                                x:Name="BillDatePicker"
                                Style="{StaticResource RoundedDatePicker}"
                                Date="{x:Bind ViewModel.BillDate, Mode=TwoWay}" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Service Categories Section -->
            <Border Grid.Row="2" Style="{StaticResource BillCard}" Margin="0,0,0,20">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <StackPanel Spacing="16">
                        <TextBlock 
                            Text="Service Categories" 
                            Foreground="{StaticResource WhiteTextBrush}"
                            FontSize="18"
                            FontWeight="SemiBold" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            
                            <!-- Hours Section -->
                            <StackPanel Grid.Column="0" Grid.Row="0" Margin="5">
                                <Button Content="Hours" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="ms-appx:///Assets/Fonts/Ezra Bold.otf#Ezra"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnServiceClick"
                                       Tag="Hours - Red|50"/>
                                <Button Content="Hours" 
                                       Background="#3182CE" 
                                       Foreground="White"
                                       FontFamily="ms-appx:///Assets/Fonts/Ezra Bold.otf#Ezra"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Margin="0,2,0,0"
                                       Click="OnServiceClick"
                                       Tag="Hours - Blue|75"/>
                            </StackPanel>
                            
                            <!-- VHS Convert Section -->
                            <StackPanel Grid.Column="0" Grid.Row="1" Margin="5">
                                <Button Content="VHS Convert" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnServiceClick"
                                       Tag="VHS Convert - Red|10"/>
                                <Button Content="VHS Convert" 
                                       Background="#3182CE" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Margin="0,2,0,0"
                                       Click="OnServiceClick"
                                       Tag="VHS Convert - Blue|5"/>
                            </StackPanel>
                            
                            <!-- Photo Print Section -->
                            <StackPanel Grid.Column="0" Grid.Row="2" Margin="5">
                                <Button Content="Photo Print" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"/>
                                <StackPanel Background="Black" Margin="0,2,0,0">
                                    <Button Content="B&amp;W" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="40"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Photo Print B&amp;W|20"/>
                                    <Button Content="COLOR" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="40"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Photo Print Color|30"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- OS X Section -->
                            <StackPanel Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" Margin="5">
                                <Button x:Name="OSXHeaderButton"
                                       Content="OS X ▼" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnToggleOSXClick"/>
                                <StackPanel x:Name="OSXSubPanel" 
                                           Background="Black" 
                                           Margin="0,2,0,0"
                                           Visibility="Visible">
                                    <Button Content="Big Sur 11 (20)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Big Sur 11 (20)|30|OS X"/>
                                    <Button Content="Monterey 12 (21)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Monterey 12 (21)|30|OS X"/>
                                    <Button Content="Ventura 13 (22)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Ventura 13 (22)|30|OS X"/>
                                    <Button Content="Sonoma 14 (23)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Sonoma 14 (23)|30|OS X"/>
                                    <Button Content="Sequoia 15 (24)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Sequoia 15 (24)|30|OS X"/>
                                    <Button Content="Tahoe 26 (25)" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnServiceClick"
                                           Tag="Tahoe 26 (25)|30|OS X"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Laser Section -->
                            <StackPanel Grid.Column="1" Grid.Row="2" Margin="5">
                                <Button x:Name="LaserHeaderButton"
                                       Content="LASER ▼" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnToggleLaserClick"/>
                                <StackPanel x:Name="LaserSubPanel" 
                                           Background="Black" 
                                           Margin="0,2,0,0"
                                           Visibility="Visible">
                                    <Button Content="Materials" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Materials|LASER"/>
                                    <Button Content="Packaging" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Packaging|LASER"/>
                                    <Button Content="Time Mark" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Time Mark|LASER"/>
                                    <Button Content="Time Engrave" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Time Engrave|LASER"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Equipment Section -->
                            <StackPanel Grid.Column="2" Grid.Row="0" Grid.RowSpan="3" Margin="5">
                                <Button x:Name="EquipmentHeaderButton"
                                       Content="Equipment ▼" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnToggleEquipmentClick"/>
                                <StackPanel x:Name="EquipmentSubPanel" 
                                           Background="Black" 
                                           Margin="0,2,0,0"
                                           Visibility="Visible">
                                    <Button Content="RAM" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="RAM|EQUIPMENT"/>
                                    <Button Content="Laptop" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Laptop|EQUIPMENT"/>
                                    <Button Content="Desktop" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Desktop|EQUIPMENT"/>
                                    <Button Content="Modem" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Modem|EQUIPMENT"/>
                                    <Button Content="Router" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Router|EQUIPMENT"/>
                                    <Button Content="Monitor" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Monitor|EQUIPMENT"/>
                                    <Button Content="NVME" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="NVME|EQUIPMENT"/>
                                    <Button Content="KB&amp;M" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="KB&amp;M|EQUIPMENT"/>
                                    <Button Content="Sec. Camera" 
                                           Background="Black" 
                                           Foreground="White"
                                           FontFamily="{StaticResource EzraBoldFont}"
                                           FontSize="14"
                                           Height="35"
                                           HorizontalAlignment="Stretch"
                                           BorderThickness="0"
                                           Click="OnEditablePriceServiceClick"
                                           Tag="Sec. Camera|EQUIPMENT"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- CUSTOM Section -->
                            <StackPanel Grid.Column="0" Grid.Row="3" Margin="5">
                                <Button Content="CUSTOM" 
                                       Background="#E53E3E" 
                                       Foreground="White"
                                       FontFamily="{StaticResource EzraBoldFont}"
                                       FontSize="16"
                                       Height="50"
                                       HorizontalAlignment="Stretch"
                                       Click="OnCustomServiceClick"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Current Bill Section -->
            <Border Grid.Row="3" Style="{StaticResource BillCard}">
                <StackPanel Spacing="16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock 
                            Grid.Column="0"
                            Text="Current Bill" 
                            Foreground="{StaticResource WhiteTextBrush}"
                            FontSize="18"
                            FontWeight="SemiBold" />
                        
                        <TextBlock 
                            Grid.Column="1"
                            Text="{x:Bind ViewModel.TotalAmount, Mode=OneWay}"
                            Foreground="{StaticResource RedAccentBrush}"
                            FontSize="18"
                            FontFamily="{StaticResource EzraBoldFont}" />
                    </Grid>
                    
                    <!-- Bill Items List -->
                    <ListView 
                        x:Name="BillItemsListView"
                        ItemsSource="{x:Bind ViewModel.BillItems, Mode=OneWay}"
                        Background="Transparent"
                        BorderThickness="0"
                        SelectionMode="None"
                        MaxHeight="300">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="0,8" Background="Transparent">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock 
                                        Grid.Column="0"
                                        Text="{Binding Description}"
                                        Foreground="{StaticResource WhiteTextBrush}"
                                        FontSize="14"
                                        VerticalAlignment="Center" />
                                    
                                    <TextBlock 
                                        Grid.Column="1"
                                        Text="{Binding Quantity}"
                                        Foreground="{StaticResource LightGreyTextBrush}"
                                        FontSize="14"
                                        Margin="16,0"
                                        VerticalAlignment="Center" />
                                    
                                    <TextBlock 
                                        Grid.Column="2"
                                        Text="{Binding TotalPrice, Converter={StaticResource CurrencyConverter}}"
                                        Foreground="{StaticResource RedAccentBrush}"
                                        FontSize="14"
                                        FontFamily="{StaticResource EzraBoldFont}"
                                        Margin="16,0"
                                        VerticalAlignment="Center" />
                                    
                                    <Button 
                                        Grid.Column="3"
                                        Content="✎"
                                        Background="Transparent"
                                        Foreground="{StaticResource LightGreyTextBrush}"
                                        BorderThickness="0"
                                        FontSize="14"
                                        Padding="8,4"
                                        Margin="8,0,0,0"
                                        VerticalAlignment="Center"
                                        Click="OnEditItemClick"
                                        Tag="{Binding}"
                                        ToolTipService.ToolTip="Edit item" />
                                    
                                    <Button 
                                        Grid.Column="4"
                                        Content="✕"
                                        Background="Transparent"
                                        Foreground="{StaticResource LightGreyTextBrush}"
                                        BorderThickness="0"
                                        FontSize="12"
                                        Padding="8,4"
                                        Margin="8,0,0,0"
                                        VerticalAlignment="Center"
                                        Click="OnRemoveItemClick"
                                        Tag="{Binding}"
                                        ToolTipService.ToolTip="Remove item" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                    
                    <!-- Action Buttons -->
                    <Grid Margin="0,16,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <Button 
                            Grid.Column="0"
                            Style="{StaticResource RedAccentButton}"
                            Content="Save Bill"
                            Command="{x:Bind ViewModel.SaveBillCommand}"
                            IsEnabled="{x:Bind ViewModel.CanSaveBill, Mode=OneWay}" />
                        
                        <Button 
                            Grid.Column="2"
                            Style="{StaticResource RedAccentButton}"
                            Content="Preview Bill"
                            Command="{x:Bind ViewModel.PreviewBillCommand}"
                            IsEnabled="{x:Bind ViewModel.CanPreviewBill, Mode=OneWay}" />
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</Page>
